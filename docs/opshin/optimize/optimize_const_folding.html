<!doctype html>
<html lang="en">
<head>
<style>.homelink{display:block;font-size:2em;font-weight:bold;color:#555;padding-bottom:.5em;border-bottom:1px solid silver}.homelink:hover{color:inherit}.homelink img{max-width:20%;max-height:5em;margin:auto;margin-bottom:.3em}</style>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.11.1" />
<link rel="icon" href="https://raw.githubusercontent.com/OpShin/opshin/dev/docs/opshin_32.png" sizes="32x32" type="image/png">
<title>opshin.optimize.optimize_const_folding API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<style>
.github-corner:hover .octo-arm {
animation: octocat-wave 560ms ease-in-out
}
@keyframes octocat-wave {
0%,
100% {
transform: rotate(0)
}
20%,
60% {
transform: rotate(-25deg)
}
40%,
80% {
transform: rotate(10deg)
}
}
@media (max-width:500px) {
.github-corner:hover .octo-arm {
animation: none
}
.github-corner .octo-arm {
animation: octocat-wave 560ms ease-in-out
}
}
</style>
<a href="https://github.com/opshin/opshin" class="github-corner" aria-label="View source on GitHub">
<svg width="80" height="80" viewBox="0 0 250 250"
style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
<path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z">
</path>
<path
d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
<path
d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
fill="currentColor" class="octo-body"></path>
</svg>
</a>
<article id="content">
<header>
<h1 class="title">Module <code>opshin.optimize.optimize_const_folding</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import typing
from collections import defaultdict
import logging

from ast import *
from ordered_set import OrderedSet

from pycardano import PlutusData

try:
    unparse
except NameError:
    from astunparse import unparse

from ..util import CompilingNodeTransformer, CompilingNodeVisitor, OPSHIN_LOGGER
from ..type_inference import INITIAL_SCOPE

&#34;&#34;&#34;
Pre-evaluates constant statements
&#34;&#34;&#34;

ACCEPTED_ATOMIC_TYPES = [
    int,
    str,
    bytes,
    type(None),
    bool,
]

SAFE_GLOBALS_LIST = [
    abs,
    all,
    any,
    ascii,
    bin,
    bool,
    bytes,
    bytearray,
    callable,
    chr,
    classmethod,
    compile,
    complex,
    delattr,
    dict,
    dir,
    divmod,
    enumerate,
    filter,
    float,
    format,
    frozenset,
    getattr,
    hasattr,
    hash,
    hex,
    id,
    input,
    int,
    isinstance,
    issubclass,
    iter,
    len,
    list,
    map,
    max,
    min,
    next,
    object,
    oct,
    open,
    ord,
    pow,
    print,
    property,
    range,
    repr,
    reversed,
    round,
    set,
    setattr,
    slice,
    sorted,
    staticmethod,
    str,
    sum,
    super,
    tuple,
    type,
    vars,
    zip,
]
SAFE_GLOBALS = {x.__name__: x for x in SAFE_GLOBALS_LIST}


class ShallowNameDefCollector(CompilingNodeVisitor):
    step = &#34;Collecting occuring variable names&#34;

    def __init__(self):
        self.vars = OrderedSet()

    def visit_Name(self, node: Name) -&gt; None:
        if isinstance(node.ctx, Store):
            self.vars.add(node.id)

    def visit_ClassDef(self, node: ClassDef):
        self.vars.add(node.name)
        # ignore the content (i.e. attribute names) of class definitions

    def visit_FunctionDef(self, node: FunctionDef):
        self.vars.add(node.name)
        # ignore the recursive stuff


class DefinedTimesVisitor(CompilingNodeVisitor):
    step = &#34;Collecting how often variables are written&#34;

    def __init__(self):
        self.vars = defaultdict(int)

    def visit_For(self, node: For) -&gt; None:
        # visit twice to have all names bumped to min 2 assignments
        self.generic_visit(node)
        self.generic_visit(node)
        return
        # TODO future items: use this together with guaranteed available
        # visit twice to have this name bumped to min 2 assignments
        self.visit(node.target)
        # visit the whole function
        self.generic_visit(node)

    def visit_While(self, node: While) -&gt; None:
        # visit twice to have all names bumped to min 2 assignments
        self.generic_visit(node)
        self.generic_visit(node)
        return
        # TODO future items: use this together with guaranteed available

    def visit_If(self, node: If) -&gt; None:
        # TODO future items: use this together with guaranteed available
        # visit twice to have all names bumped to min 2 assignments
        self.generic_visit(node)
        self.generic_visit(node)

    def visit_Name(self, node: Name) -&gt; None:
        if isinstance(node.ctx, Store):
            self.vars[node.id] += 1

    def visit_ClassDef(self, node: ClassDef):
        self.vars[node.name] += 1
        # ignore the content (i.e. attribute names) of class definitions

    def visit_FunctionDef(self, node: FunctionDef):
        self.vars[node.name] += 1
        # visit arguments twice, they are generally assigned more than once
        for arg in node.args.args:
            self.vars[arg.arg] += 2
        self.generic_visit(node)

    def visit_Import(self, node: Import):
        for n in node.names:
            self.vars[n] += 1

    def visit_ImportFrom(self, node: ImportFrom):
        for n in node.names:
            self.vars[n] += 1


class OptimizeConstantFolding(CompilingNodeTransformer):
    step = &#34;Constant folding&#34;

    def __init__(self):
        self.scopes_visible = [
            OrderedSet(INITIAL_SCOPE.keys()).difference(SAFE_GLOBALS.keys())
        ]
        self.scopes_constants = [dict()]
        self.constants = OrderedSet()

    def enter_scope(self):
        self.scopes_visible.append(OrderedSet())
        self.scopes_constants.append(dict())

    def add_var_visible(self, var: str):
        self.scopes_visible[-1].add(var)

    def add_vars_visible(self, var: typing.Iterable[str]):
        self.scopes_visible[-1].update(var)

    def add_constant(self, var: str, value: typing.Any):
        self.scopes_constants[-1][var] = value

    def visible_vars(self):
        res_set = OrderedSet()
        for s in self.scopes_visible:
            res_set.update(s)
        return res_set

    def _constant_vars(self):
        res_d = {}
        for s in self.scopes_constants:
            res_d.update(s)
        return res_d

    def exit_scope(self):
        self.scopes_visible.pop(-1)
        self.scopes_constants.pop(-1)

    def _non_overwritten_globals(self):
        overwritten_vars = self.visible_vars()

        def err():
            raise ValueError(&#34;Was overwritten!&#34;)

        non_overwritten_globals = {
            k: (v if k not in overwritten_vars else err)
            for k, v in SAFE_GLOBALS.items()
        }
        return non_overwritten_globals

    def update_constants(self, node):
        a = self._non_overwritten_globals()
        a.update(self._constant_vars())
        g = a
        l = {}
        try:
            exec(unparse(node), g, l)
        except Exception as e:
            OPSHIN_LOGGER.debug(e)
        else:
            # the class is defined and added to the globals
            self.scopes_constants[-1].update(l)

    def visit_Module(self, node: Module) -&gt; Module:
        self.enter_scope()
        def_vars_collector = ShallowNameDefCollector()
        def_vars_collector.visit(node)
        def_vars = def_vars_collector.vars
        self.add_vars_visible(def_vars)

        constant_collector = DefinedTimesVisitor()
        constant_collector.visit(node)
        constants = constant_collector.vars
        # if it is only assigned exactly once, it must be a constant (due to immutability)
        self.constants = {c for c, i in constants.items() if i == 1}

        res = self.generic_visit(node)
        self.exit_scope()
        return res

    def visit_FunctionDef(self, node: FunctionDef) -&gt; FunctionDef:
        self.add_var_visible(node.name)
        if node.name in self.constants:
            a = self._non_overwritten_globals()
            a.update(self._constant_vars())
            g = a
            try:
                # we need to pass the global dict as local dict here to make closures possible (rec functions)
                exec(unparse(node), g, g)
            except Exception as e:
                OPSHIN_LOGGER.debug(e)
            else:
                # the class is defined and added to the globals
                self.scopes_constants[-1][node.name] = g[node.name]

        self.enter_scope()
        self.add_vars_visible(arg.arg for arg in node.args.args)
        def_vars_collector = ShallowNameDefCollector()
        for s in node.body:
            def_vars_collector.visit(s)
        def_vars = def_vars_collector.vars
        self.add_vars_visible(def_vars)

        res_node = self.generic_visit(node)
        self.exit_scope()
        return res_node

    def visit_ClassDef(self, node: ClassDef):
        if node.name in self.constants:
            self.update_constants(node)
        return node

    def visit_ImportFrom(self, node: ImportFrom):
        if all(n in self.constants for n in node.names):
            self.update_constants(node)
        return node

    def visit_Import(self, node: Import):
        if all(n in self.constants for n in node.names):
            self.update_constants(node)
        return node

    def visit_Assign(self, node: Assign):
        if len(node.targets) != 1:
            return node
        target = node.targets[0]
        if not isinstance(target, Name):
            return node

        if target.id in self.constants:
            self.update_constants(node)
        node.value = self.visit(node.value)
        return node

    def visit_AnnAssign(self, node: AnnAssign):
        target = node.target
        if not isinstance(target, Name):
            return node

        if target.id in self.constants:
            self.update_constants(node)
        node.value = self.visit(node.value)
        return node

    def generic_visit(self, node: AST):
        node = super().generic_visit(node)
        if not isinstance(node, expr):
            # only evaluate expressions, not statements
            return node
        if isinstance(node, Constant):
            # prevents unneccessary computations
            return node
        try:
            node_source = unparse(node)
        except Exception as e:
            OPSHIN_LOGGER.debug(&#34;Error when trying to unparse node: %s&#34;, e)
            return node
        if &#34;print(&#34; in node_source:
            # do not optimize away print statements
            return node
        try:
            # we add preceding constant plutusdata definitions here!
            g = self._non_overwritten_globals()
            l = self._constant_vars()
            node_eval = eval(node_source, g, l)
        except Exception as e:
            OPSHIN_LOGGER.debug(&#34;Error trying to evaluate node: %s&#34;, e)
            return node

        if any(
            isinstance(node_eval, t)
            for t in ACCEPTED_ATOMIC_TYPES + [list, dict, PlutusData]
        ) and not (node_eval == [] or node_eval == {}):
            new_node = Constant(node_eval, None)
            copy_location(new_node, node)
            return new_node
        return node</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor"><code class="flex name class">
<span>class <span class="ident">DefinedTimesVisitor</span></span>
</code></dt>
<dd>
<div class="desc"><p>A node visitor base class that walks the abstract syntax tree and calls a
visitor function for every node found.
This function may return a value
which is forwarded by the <code>visit</code> method.</p>
<p>This class is meant to be subclassed, with the subclass adding visitor
methods.</p>
<p>Per default the visitor functions for the nodes are <code>'visit_'</code> +
class name of the node.
So a <code>TryFinally</code> node visit function would
be <code>visit_TryFinally</code>.
This behavior can be changed by overriding
the <code>visit</code> method.
If no visitor function exists for a node
(return value <code>None</code>) the <code>generic_visit</code> visitor is used instead.</p>
<p>Don't use the <code>NodeVisitor</code> if you want to apply changes to nodes during
traversing.
For this a special visitor exists (<code>NodeTransformer</code>) that
allows modifications.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DefinedTimesVisitor(CompilingNodeVisitor):
    step = &#34;Collecting how often variables are written&#34;

    def __init__(self):
        self.vars = defaultdict(int)

    def visit_For(self, node: For) -&gt; None:
        # visit twice to have all names bumped to min 2 assignments
        self.generic_visit(node)
        self.generic_visit(node)
        return
        # TODO future items: use this together with guaranteed available
        # visit twice to have this name bumped to min 2 assignments
        self.visit(node.target)
        # visit the whole function
        self.generic_visit(node)

    def visit_While(self, node: While) -&gt; None:
        # visit twice to have all names bumped to min 2 assignments
        self.generic_visit(node)
        self.generic_visit(node)
        return
        # TODO future items: use this together with guaranteed available

    def visit_If(self, node: If) -&gt; None:
        # TODO future items: use this together with guaranteed available
        # visit twice to have all names bumped to min 2 assignments
        self.generic_visit(node)
        self.generic_visit(node)

    def visit_Name(self, node: Name) -&gt; None:
        if isinstance(node.ctx, Store):
            self.vars[node.id] += 1

    def visit_ClassDef(self, node: ClassDef):
        self.vars[node.name] += 1
        # ignore the content (i.e. attribute names) of class definitions

    def visit_FunctionDef(self, node: FunctionDef):
        self.vars[node.name] += 1
        # visit arguments twice, they are generally assigned more than once
        for arg in node.args.args:
            self.vars[arg.arg] += 2
        self.generic_visit(node)

    def visit_Import(self, node: Import):
        for n in node.names:
            self.vars[n] += 1

    def visit_ImportFrom(self, node: ImportFrom):
        for n in node.names:
            self.vars[n] += 1</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="opshin.util.CompilingNodeVisitor" href="../util.html#opshin.util.CompilingNodeVisitor">CompilingNodeVisitor</a></li>
<li><a title="opshin.util.TypedNodeVisitor" href="../util.html#opshin.util.TypedNodeVisitor">TypedNodeVisitor</a></li>
<li>ast.NodeVisitor</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.step"><code class="name">var <span class="ident">step</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit"><code class="name flex">
<span>def <span class="ident">visit</span></span>(<span>self, node)</span>
</code></dt>
<dd>
<p class="inheritance">
<em>Inherited from:</em>
<code><a title="opshin.util.CompilingNodeVisitor" href="../util.html#opshin.util.CompilingNodeVisitor">CompilingNodeVisitor</a></code>.<code><a title="opshin.util.CompilingNodeVisitor.visit" href="../util.html#opshin.util.CompilingNodeVisitor.visit">visit</a></code>
</p>
<div class="desc inherited"><p>Visit a node.</p></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_ClassDef"><code class="name flex">
<span>def <span class="ident">visit_ClassDef</span></span>(<span>self, node: ast.ClassDef)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_For"><code class="name flex">
<span>def <span class="ident">visit_For</span></span>(<span>self, node: ast.For) ‑> None</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_FunctionDef"><code class="name flex">
<span>def <span class="ident">visit_FunctionDef</span></span>(<span>self, node: ast.FunctionDef)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_If"><code class="name flex">
<span>def <span class="ident">visit_If</span></span>(<span>self, node: ast.If) ‑> None</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_Import"><code class="name flex">
<span>def <span class="ident">visit_Import</span></span>(<span>self, node: ast.Import)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_ImportFrom"><code class="name flex">
<span>def <span class="ident">visit_ImportFrom</span></span>(<span>self, node: ast.ImportFrom)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_Name"><code class="name flex">
<span>def <span class="ident">visit_Name</span></span>(<span>self, node: ast.Name) ‑> None</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_While"><code class="name flex">
<span>def <span class="ident">visit_While</span></span>(<span>self, node: ast.While) ‑> None</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding"><code class="flex name class">
<span>class <span class="ident">OptimizeConstantFolding</span></span>
</code></dt>
<dd>
<div class="desc"><p>A :class:<code>NodeVisitor</code> subclass that walks the abstract syntax tree and
allows modification of nodes.</p>
<p>The <code>NodeTransformer</code> will walk the AST and use the return value of the
visitor methods to replace or remove the old node.
If the return value of
the visitor method is <code>None</code>, the node will be removed from its location,
otherwise it is replaced with the return value.
The return value may be the
original node in which case no replacement takes place.</p>
<p>Here is an example transformer that rewrites all occurrences of name lookups
(<code>foo</code>) to <code>data['foo']</code>::</p>
<p>class RewriteName(NodeTransformer):</p>
<pre><code>   def visit_Name(self, node):
       return Subscript(
           value=Name(id='data', ctx=Load()),
           slice=Constant(value=node.id),
           ctx=node.ctx
       )
</code></pre>
<p>Keep in mind that if the node you're operating on has child nodes you must
either transform the child nodes yourself or call the :meth:<code>generic_visit</code>
method for the node first.</p>
<p>For nodes that were part of a collection of statements (that applies to all
statement nodes), the visitor may also return a list of nodes rather than
just a single node.</p>
<p>Usually you use the transformer like this::</p>
<p>node = YourTransformer().visit(node)</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class OptimizeConstantFolding(CompilingNodeTransformer):
    step = &#34;Constant folding&#34;

    def __init__(self):
        self.scopes_visible = [
            OrderedSet(INITIAL_SCOPE.keys()).difference(SAFE_GLOBALS.keys())
        ]
        self.scopes_constants = [dict()]
        self.constants = OrderedSet()

    def enter_scope(self):
        self.scopes_visible.append(OrderedSet())
        self.scopes_constants.append(dict())

    def add_var_visible(self, var: str):
        self.scopes_visible[-1].add(var)

    def add_vars_visible(self, var: typing.Iterable[str]):
        self.scopes_visible[-1].update(var)

    def add_constant(self, var: str, value: typing.Any):
        self.scopes_constants[-1][var] = value

    def visible_vars(self):
        res_set = OrderedSet()
        for s in self.scopes_visible:
            res_set.update(s)
        return res_set

    def _constant_vars(self):
        res_d = {}
        for s in self.scopes_constants:
            res_d.update(s)
        return res_d

    def exit_scope(self):
        self.scopes_visible.pop(-1)
        self.scopes_constants.pop(-1)

    def _non_overwritten_globals(self):
        overwritten_vars = self.visible_vars()

        def err():
            raise ValueError(&#34;Was overwritten!&#34;)

        non_overwritten_globals = {
            k: (v if k not in overwritten_vars else err)
            for k, v in SAFE_GLOBALS.items()
        }
        return non_overwritten_globals

    def update_constants(self, node):
        a = self._non_overwritten_globals()
        a.update(self._constant_vars())
        g = a
        l = {}
        try:
            exec(unparse(node), g, l)
        except Exception as e:
            OPSHIN_LOGGER.debug(e)
        else:
            # the class is defined and added to the globals
            self.scopes_constants[-1].update(l)

    def visit_Module(self, node: Module) -&gt; Module:
        self.enter_scope()
        def_vars_collector = ShallowNameDefCollector()
        def_vars_collector.visit(node)
        def_vars = def_vars_collector.vars
        self.add_vars_visible(def_vars)

        constant_collector = DefinedTimesVisitor()
        constant_collector.visit(node)
        constants = constant_collector.vars
        # if it is only assigned exactly once, it must be a constant (due to immutability)
        self.constants = {c for c, i in constants.items() if i == 1}

        res = self.generic_visit(node)
        self.exit_scope()
        return res

    def visit_FunctionDef(self, node: FunctionDef) -&gt; FunctionDef:
        self.add_var_visible(node.name)
        if node.name in self.constants:
            a = self._non_overwritten_globals()
            a.update(self._constant_vars())
            g = a
            try:
                # we need to pass the global dict as local dict here to make closures possible (rec functions)
                exec(unparse(node), g, g)
            except Exception as e:
                OPSHIN_LOGGER.debug(e)
            else:
                # the class is defined and added to the globals
                self.scopes_constants[-1][node.name] = g[node.name]

        self.enter_scope()
        self.add_vars_visible(arg.arg for arg in node.args.args)
        def_vars_collector = ShallowNameDefCollector()
        for s in node.body:
            def_vars_collector.visit(s)
        def_vars = def_vars_collector.vars
        self.add_vars_visible(def_vars)

        res_node = self.generic_visit(node)
        self.exit_scope()
        return res_node

    def visit_ClassDef(self, node: ClassDef):
        if node.name in self.constants:
            self.update_constants(node)
        return node

    def visit_ImportFrom(self, node: ImportFrom):
        if all(n in self.constants for n in node.names):
            self.update_constants(node)
        return node

    def visit_Import(self, node: Import):
        if all(n in self.constants for n in node.names):
            self.update_constants(node)
        return node

    def visit_Assign(self, node: Assign):
        if len(node.targets) != 1:
            return node
        target = node.targets[0]
        if not isinstance(target, Name):
            return node

        if target.id in self.constants:
            self.update_constants(node)
        node.value = self.visit(node.value)
        return node

    def visit_AnnAssign(self, node: AnnAssign):
        target = node.target
        if not isinstance(target, Name):
            return node

        if target.id in self.constants:
            self.update_constants(node)
        node.value = self.visit(node.value)
        return node

    def generic_visit(self, node: AST):
        node = super().generic_visit(node)
        if not isinstance(node, expr):
            # only evaluate expressions, not statements
            return node
        if isinstance(node, Constant):
            # prevents unneccessary computations
            return node
        try:
            node_source = unparse(node)
        except Exception as e:
            OPSHIN_LOGGER.debug(&#34;Error when trying to unparse node: %s&#34;, e)
            return node
        if &#34;print(&#34; in node_source:
            # do not optimize away print statements
            return node
        try:
            # we add preceding constant plutusdata definitions here!
            g = self._non_overwritten_globals()
            l = self._constant_vars()
            node_eval = eval(node_source, g, l)
        except Exception as e:
            OPSHIN_LOGGER.debug(&#34;Error trying to evaluate node: %s&#34;, e)
            return node

        if any(
            isinstance(node_eval, t)
            for t in ACCEPTED_ATOMIC_TYPES + [list, dict, PlutusData]
        ) and not (node_eval == [] or node_eval == {}):
            new_node = Constant(node_eval, None)
            copy_location(new_node, node)
            return new_node
        return node</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="opshin.util.CompilingNodeTransformer" href="../util.html#opshin.util.CompilingNodeTransformer">CompilingNodeTransformer</a></li>
<li><a title="opshin.util.TypedNodeTransformer" href="../util.html#opshin.util.TypedNodeTransformer">TypedNodeTransformer</a></li>
<li>ast.NodeTransformer</li>
<li>ast.NodeVisitor</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.step"><code class="name">var <span class="ident">step</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.add_constant"><code class="name flex">
<span>def <span class="ident">add_constant</span></span>(<span>self, var: str, value: Any)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.add_var_visible"><code class="name flex">
<span>def <span class="ident">add_var_visible</span></span>(<span>self, var: str)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.add_vars_visible"><code class="name flex">
<span>def <span class="ident">add_vars_visible</span></span>(<span>self, var: Iterable[str])</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.enter_scope"><code class="name flex">
<span>def <span class="ident">enter_scope</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.exit_scope"><code class="name flex">
<span>def <span class="ident">exit_scope</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.generic_visit"><code class="name flex">
<span>def <span class="ident">generic_visit</span></span>(<span>self, node: ast.AST)</span>
</code></dt>
<dd>
<div class="desc"><p>Called if no explicit visitor function exists for a node.</p></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.update_constants"><code class="name flex">
<span>def <span class="ident">update_constants</span></span>(<span>self, node)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visible_vars"><code class="name flex">
<span>def <span class="ident">visible_vars</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit"><code class="name flex">
<span>def <span class="ident">visit</span></span>(<span>self, node)</span>
</code></dt>
<dd>
<p class="inheritance">
<em>Inherited from:</em>
<code><a title="opshin.util.CompilingNodeTransformer" href="../util.html#opshin.util.CompilingNodeTransformer">CompilingNodeTransformer</a></code>.<code><a title="opshin.util.CompilingNodeTransformer.visit" href="../util.html#opshin.util.CompilingNodeTransformer.visit">visit</a></code>
</p>
<div class="desc inherited"><p>Visit a node.</p></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_AnnAssign"><code class="name flex">
<span>def <span class="ident">visit_AnnAssign</span></span>(<span>self, node: ast.AnnAssign)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_Assign"><code class="name flex">
<span>def <span class="ident">visit_Assign</span></span>(<span>self, node: ast.Assign)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_ClassDef"><code class="name flex">
<span>def <span class="ident">visit_ClassDef</span></span>(<span>self, node: ast.ClassDef)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_FunctionDef"><code class="name flex">
<span>def <span class="ident">visit_FunctionDef</span></span>(<span>self, node: ast.FunctionDef) ‑> ast.FunctionDef</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_Import"><code class="name flex">
<span>def <span class="ident">visit_Import</span></span>(<span>self, node: ast.Import)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_ImportFrom"><code class="name flex">
<span>def <span class="ident">visit_ImportFrom</span></span>(<span>self, node: ast.ImportFrom)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_Module"><code class="name flex">
<span>def <span class="ident">visit_Module</span></span>(<span>self, node: ast.Module) ‑> ast.Module</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="opshin.optimize.optimize_const_folding.ShallowNameDefCollector"><code class="flex name class">
<span>class <span class="ident">ShallowNameDefCollector</span></span>
</code></dt>
<dd>
<div class="desc"><p>A node visitor base class that walks the abstract syntax tree and calls a
visitor function for every node found.
This function may return a value
which is forwarded by the <code>visit</code> method.</p>
<p>This class is meant to be subclassed, with the subclass adding visitor
methods.</p>
<p>Per default the visitor functions for the nodes are <code>'visit_'</code> +
class name of the node.
So a <code>TryFinally</code> node visit function would
be <code>visit_TryFinally</code>.
This behavior can be changed by overriding
the <code>visit</code> method.
If no visitor function exists for a node
(return value <code>None</code>) the <code>generic_visit</code> visitor is used instead.</p>
<p>Don't use the <code>NodeVisitor</code> if you want to apply changes to nodes during
traversing.
For this a special visitor exists (<code>NodeTransformer</code>) that
allows modifications.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ShallowNameDefCollector(CompilingNodeVisitor):
    step = &#34;Collecting occuring variable names&#34;

    def __init__(self):
        self.vars = OrderedSet()

    def visit_Name(self, node: Name) -&gt; None:
        if isinstance(node.ctx, Store):
            self.vars.add(node.id)

    def visit_ClassDef(self, node: ClassDef):
        self.vars.add(node.name)
        # ignore the content (i.e. attribute names) of class definitions

    def visit_FunctionDef(self, node: FunctionDef):
        self.vars.add(node.name)
        # ignore the recursive stuff</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="opshin.util.CompilingNodeVisitor" href="../util.html#opshin.util.CompilingNodeVisitor">CompilingNodeVisitor</a></li>
<li><a title="opshin.util.TypedNodeVisitor" href="../util.html#opshin.util.TypedNodeVisitor">TypedNodeVisitor</a></li>
<li>ast.NodeVisitor</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="opshin.optimize.optimize_const_folding.ShallowNameDefCollector.step"><code class="name">var <span class="ident">step</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit"><code class="name flex">
<span>def <span class="ident">visit</span></span>(<span>self, node)</span>
</code></dt>
<dd>
<p class="inheritance">
<em>Inherited from:</em>
<code><a title="opshin.util.CompilingNodeVisitor" href="../util.html#opshin.util.CompilingNodeVisitor">CompilingNodeVisitor</a></code>.<code><a title="opshin.util.CompilingNodeVisitor.visit" href="../util.html#opshin.util.CompilingNodeVisitor.visit">visit</a></code>
</p>
<div class="desc inherited"><p>Visit a node.</p></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit_ClassDef"><code class="name flex">
<span>def <span class="ident">visit_ClassDef</span></span>(<span>self, node: ast.ClassDef)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit_FunctionDef"><code class="name flex">
<span>def <span class="ident">visit_FunctionDef</span></span>(<span>self, node: ast.FunctionDef)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit_Name"><code class="name flex">
<span>def <span class="ident">visit_Name</span></span>(<span>self, node: ast.Name) ‑> None</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div style="max-width: 330px; margin-bottom: 10px">
<header>
<a class="homelink" rel="home" title="opshin Home" href="https://opshin.opshin.dev/">
<img src="https://raw.githubusercontent.com/OpShin/opshin/master/opshin.png" alt="opshin logo"> &nbsp; opshin
</a>
</header>
</div>
<form>
<input id="lunr-search" name="q" placeholder="🔎 Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.16.0/tingle.min.css" integrity="sha512-b+T2i3P45i1LZM7I00Ci5QquB9szqaxu+uuk5TUSGjZQ4w4n+qujQiIuvTv2BxE7WCGQCifNMksyKILDiHzsOg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.16.0/tingle.min.js" integrity="sha512-2B9/byNV1KKRm5nQ2RLViPFD6U4dUjDGwuW1GU+ImJh8YinPU9Zlq1GzdTMO+G2ROrB5o1qasJBy1ttYz0wCug==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="opshin.optimize" href="index.html">opshin.optimize</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor" href="#opshin.optimize.optimize_const_folding.DefinedTimesVisitor">DefinedTimesVisitor</a></code></h4>
<ul class="two-column">
<li><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.step" href="#opshin.optimize.optimize_const_folding.DefinedTimesVisitor.step">step</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit" href="../util.html#opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit">visit</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_ClassDef" href="#opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_ClassDef">visit_ClassDef</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_For" href="#opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_For">visit_For</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_FunctionDef" href="#opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_FunctionDef">visit_FunctionDef</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_If" href="#opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_If">visit_If</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_Import" href="#opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_Import">visit_Import</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_ImportFrom" href="#opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_ImportFrom">visit_ImportFrom</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_Name" href="#opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_Name">visit_Name</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_While" href="#opshin.optimize.optimize_const_folding.DefinedTimesVisitor.visit_While">visit_While</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding">OptimizeConstantFolding</a></code></h4>
<ul class="two-column">
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.add_constant" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.add_constant">add_constant</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.add_var_visible" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.add_var_visible">add_var_visible</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.add_vars_visible" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.add_vars_visible">add_vars_visible</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.enter_scope" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.enter_scope">enter_scope</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.exit_scope" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.exit_scope">exit_scope</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.generic_visit" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.generic_visit">generic_visit</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.step" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.step">step</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.update_constants" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.update_constants">update_constants</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visible_vars" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visible_vars">visible_vars</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit" href="../util.html#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit">visit</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_AnnAssign" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_AnnAssign">visit_AnnAssign</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_Assign" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_Assign">visit_Assign</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_ClassDef" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_ClassDef">visit_ClassDef</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_FunctionDef" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_FunctionDef">visit_FunctionDef</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_Import" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_Import">visit_Import</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_ImportFrom" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_ImportFrom">visit_ImportFrom</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_Module" href="#opshin.optimize.optimize_const_folding.OptimizeConstantFolding.visit_Module">visit_Module</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="opshin.optimize.optimize_const_folding.ShallowNameDefCollector" href="#opshin.optimize.optimize_const_folding.ShallowNameDefCollector">ShallowNameDefCollector</a></code></h4>
<ul class="">
<li><code><a title="opshin.optimize.optimize_const_folding.ShallowNameDefCollector.step" href="#opshin.optimize.optimize_const_folding.ShallowNameDefCollector.step">step</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit" href="../util.html#opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit">visit</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit_ClassDef" href="#opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit_ClassDef">visit_ClassDef</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit_FunctionDef" href="#opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit_FunctionDef">visit_FunctionDef</a></code></li>
<li><code><a title="opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit_Name" href="#opshin.optimize.optimize_const_folding.ShallowNameDefCollector.visit_Name">visit_Name</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
